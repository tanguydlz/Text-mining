tidytext <- tibble(line = 1:length(VarDiag), text = VarDiag)
#source
n=2
tidytext <- tidytext %>%
unnest_tokens(ngram, text, token = "ngrams", n = n)
if (n==1) {tidytext <- tidytext %>% anti_join(stop_words)}
tidytext <- tidytext %>% count(ngram, sort = TRUE)
wordcloud(tidytext$ngram,tidytext$line,max.words=20,color=c("lightblue3","lightblue4","darkcyan"))
tidytext
wordcloud(tidytext$ngram,tidytext$n,max.words=20,color=c("lightblue3","lightblue4","darkcyan"))
tidytext <- tibble(line = 1:length(VarDiag), text = VarDiag)
tidytext <- tidytext %>%
unnest_tokens(ngram, text, token = "ngrams", n = n)
tidytext %>%
separate(word, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word) %>%
filter(!word2 %in% stop_words$word) %>%
unite(word,word1, word2, sep = " ") %>%
count(word, sort = TRUE)
is.na(2)
is.na(NA)
tidytext %>%
filter(!is.na(ngram))
tidytext <- tidytext %>%
unnest_tokens(ngram, text, token = "ngrams", n = n)  %>%
filter(!is.na(ngram))
tidytext <- tibble(line = 1:length(VarDiag), text = VarDiag)
tidytext <- tidytext %>%
unnest_tokens(ngram, text, token = "ngrams", n = n)  %>%
filter(!is.na(ngram))
tidytext <- tidytext %>% count(ngram, sort = TRUE)
wordcloud(tidytext$ngram,tidytext$n,max.words=20,color=c("lightblue3","lightblue4","darkcyan"))
BigramTokenizer =function(x){
unlist(lapply(ngrams(words(x), 2), paste, collapse = " "), use.names = FALSE)
}
shiny::runApp('Projet_TM')
runApp()
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp()
runApp('Projet_TM')
runApp('Projet_TM')
X=new_df[,1:2]
#, "diagnostique", "jeux.et.activité"
colnames(X) = c("preoccupations","motif")
text_df <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2])
tidytext = text_df %>% unnest_tokens(word, as.numeric(input$selectVar))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
tidytext = text_df %>% unnest_tokens(word, as.numeric(input$selectVar))
tidytext = text_df %>% unnest_tokens(word, as.numeric(2))
tidytext
tidytext = text_df %>% unnest_tokens(word, as.numeric(3))
tidytext
tidytext[,-2]
tidytext = text_df %>% unnest_tokens(word, as.numeric(3))
tidytext[,-2]
head(new_df)
X=new_df[,1:4]
colnames(X) = c("preoccupations","motif", "diagnostique", "jeux")
text_df <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2],diagnostique=X[,3], jeux=X[,4])
tidytext = text_df %>% unnest_tokens(word, as.numeric(2)
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
})
tidytext = text_df %>% unnest_tokens(word, as.numeric(2))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
freq=test_clean_df %>%
count(word,sort=T)
freq
tidytext = text_df %>% unnest_tokens(word, as.numeric(2))
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
freq=test_clean_df %>%
count(word,sort=T)
freq
runApp('Projet_TM')
colnames(new_df)
runApp('Projet_TM')
runApp('Projet_TM')
X=new_df[,1:9]
colnames(X) = c("preoccupations","motif", "diagnostique", "jeux","sommeil","contact","habitute","qui","antecedents")
text_df <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2],diagnostique=X[,3], jeux=X[,4], sommeil=X[,5],contact=X[,6],habitute=X[,7],qui=X[,8],antecedents=X[,9])
X$diagnostique
X2=X[X$diagnostique!="Pas de TSA" & X$diagnostique!="",]
X=new_df[,1:9]
X2=X[X$diagnostique!="Pas de TSA" & X$diagnostique!="pas de TSA" & X$diagnostique!="",]
X$diagnostique
new_df<-data.frame(df$Préoccupations,df$Motif.de.consult,df$Diagnostic.,df$jeux.et.activités,df$Sommeil,df$Entrée.en.contact,df$Habitudes.de.l.enfant,df$Qui,df$Antécédents,df$X1eres.inquiétudes..mois.)
X=new_df[,1:9]
X2=X[X$diagnostique!="Pas de TSA" & X$diagnostique!="pas de TSA" & X$diagnostique!="",]
colnames(X) = c("preoccupations","motif", "diagnostique", "jeux","sommeil","contact","habitute","qui","antecedents")
X2=X[X$diagnostique!="Pas de TSA" & X$diagnostique!="pas de TSA" & X$diagnostique!="",]
X2$diagnostique
X2=X[X$diagnostique!="Pas de TSA%*" & X$diagnostique!="pas de TSA" & X$diagnostique!="",]
X2$diagnostique
X2=X[str_detect(X$diagnostique, "pas de TSA") & X$diagnostique!="pPas de TSA" & X$diagnostique!="",]
library(stringr)
X2=X[str_detect(X$diagnostique, "pas de TSA") & X$diagnostique!="pPas de TSA" & X$diagnostique!="",]
X2$diagnostique
X2=X[!str_detect(X$diagnostique, "pas de TSA") & X$diagnostique!="pPas de TSA" & X$diagnostique!="",]
X2$diagnostique
X2=X[!str_detect(X$diagnostique, "pas de TSA") & !str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
X2$diagnostique
colnames(df)
shiny::runApp('Inquietude')
shiny::runApp('Inquietude')
runApp('Projet_TM')
runApp('Inquietude')
runApp('Inquietude')
runApp('Inquietude')
runApp('Inquietude')
runApp('Projet_TM')
runApp('Inquietude')
runApp('Projet_TM')
library(stringr)
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
shiny::runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
shiny::runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
exists(header)
header=0
runApp('Projet_TM')
runApp('Projet_TM')
shiny::runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
runApp('Projet_TM')
bsDemo()
runApp('Projet_TM')
runApp('Projet_TM')
#Des la naissance : 0
df$X1eres.inquiétudes..mois.[str_detect(df$X1eres.inquiétudes..mois.,"naissance")]<-0
library(stringr)
#Des la naissance : 0
df$X1eres.inquiétudes..mois.[str_detect(df$X1eres.inquiétudes..mois.,"naissance")]<-0
#Recodage années en mois :
for (i in 1:length(df$X1eres.inquiétudes..mois.)) {
if (str_detect(df$X1eres.inquiétudes..mois.[i],"ans")) {
df$X1eres.inquiétudes..mois.[i]<-as.numeric(substr(df$X1eres.inquiétudes..mois.[i],1,str_locate(df$X1eres.inquiétudes..mois.[i], " ans")[1]-1))*12
}
}
#transforme la variable en numéric pour garder que les valeurs numéric
df$X1eres.inquiétudes..mois.<-as.numeric(df$X1eres.inquiétudes..mois.)
```{r}
summary(df$X1eres.inquiétudes..mois.)
library(ggplot2)
ggplot(data = df, aes(x = "", y = X1eres.inquiétudes..mois.)) +
geom_boxplot() +
ggtitle("Boxplot de l'âge des enfants lors de la première inquiétude des parents") +
ylab("Première Inquiétude en mois")
#nouvelle variable
df$tranche<-df$X1eres.inquiétudes..mois.
lapply(df$tranche, trfct)
trfct<-function(age) {
tranche<-age
if (age<18) {
tranche<-"inf18"
} else if (age<24) {
tranche<-"entre18et24"
} else if (age<36) {
tranche<-"entre24et36"
} else {
tranche<-"sup36"
}
}
lapply(df$tranche, trfct)
trfct<-function(age) {
tranche<-age
if (is.na(age)) {
tranche<-NA
} else if (age<18) {
tranche<-"inf18"
} else if (age<24) {
tranche<-"entre18et24"
} else if (age<36) {
tranche<-"entre24et36"
} else {
tranche<-"sup36"
}
}
lapply(df$tranche, trfct)
unlist(lapply(df$tranche, trfct))
df$tranche<-unlist(lapply(df$tranche, trfct))
tranche
df$tranche
#source
preoccupation_source=VectorSource(df$Préoccupations)
library(openxlsx)
library("readxl")
library(tm)
library(ngram)
library(wordcloud)
#source
preoccupation_source=VectorSource(df$Préoccupations)
preoccupation_corpus=VCorpus(preoccupation_source)
#TransformMinuscule
preoccupation_corpus= tm_map(preoccupation_corpus,content_transformer(tolower))
#removePunctuation
preoccupation_corpus = tm_map(preoccupation_corpus,removePunctuation)
#removeStopWord
preoccupation_corpus = tm_map(preoccupation_corpus,removeWords, stopwords('fr'))
#removeWhiteSpace
preoccupation_corpus = tm_map(preoccupation_corpus,stripWhitespace)
preoccupation_matrix=TermDocumentMatrix(preoccupation_corpus, control = list(tokenize=BigramTokenizer))
#matrice
M_preoccupation <- as.matrix(preoccupation_matrix)
print(nrow(M_preoccupation))
print(ncol(M_preoccupation))
#liste des termes
#print(colnames(M1))
#fréquence de chaque terme
freq_preoccupation <- apply(M_preoccupation,1,sum)
print(sort(freq_preoccupation,decreasing=TRUE)[1:10])
wordcloud(names(freq_preoccupation),freq_preoccupation,max.words=20,color=c("lightblue3","lightblue4","darkcyan"))
library(tidyr)
library(wordcloud)
library(wordcloud2)
library(reshape2)
library(plotly)
library(tidytext)
library(dplyr)
library(ggplot2)
library(tm)
library(readr)
tidytext = text_df$data %>% unnest_tokens(word, as.numeric(df$Préoccupations))
#nouvelle variable
X$tranche<-df$X1eres.inquiétudes..mois.
text_df$data <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2],diagnostique=X[,3], jeux=X[,4], sommeil=X[,5],contact=X[,6],habitute=X[,7],qui=X[,8],antecedents=X[,9],tranche=X[10])
tidytext = text_df$data %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
tidytext
X[X$tranche=="inf18"]
X[X$tranche=="inf18",]
X[X$tranche=="entre18et24",]
X$tranche
X$tranche<-unlist(lapply(df$tranche, trfct))
X$tranche
#nouvelle variable
X$tranche<-df$X1eres.inquiétudes..mois.
X$tranche<-unlist(lapply(df$X1eres.inquiétudes..mois., trfct))
X$tranche
X[X$tranche=="entre18et24",]
X
X[X$tranche=="entre18et24",]
X[X$tranche==NA,]
X$tranche<-df$X1eres.inquiétudes..mois.
trfct<-function(age) {
tranche<-age
if (is.na(age)) {
tranche<-""
} else if (age<18) {
tranche<-"inf18"
} else if (age<24) {
tranche<-"entre18et24"
} else if (age<36) {
tranche<-"entre24et36"
} else {
tranche<-"sup36"
}
}
X$tranche<-unlist(lapply(df$X1eres.inquiétudes..mois., trfct))
X[X$tranche=="inf18",]
X3<-X[X$tranche=="inf18",]
text_df$data <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
X3
X3[,1]
text_df$data <- tibble(line = 1:nrow(X3), X3$preoccupation)
X3$preoccupation
nrow(X3)
summary(df$X1eres.inquiétudes..mois.)
#nouvelle variable
X$tranche<-df$X1eres.inquiétudes..mois.
trfct<-function(age) {
tranche<-age
if (is.na(age)) {
tranche<-""
} else if (age<18) {
tranche<-"inf18"
} else if (age<24) {
tranche<-"entre18et24"
} else if (age<36) {
tranche<-"entre24et36"
} else {
tranche<-"sup36"
}
}
X$tranche<-unlist(lapply(df$X1eres.inquiétudes..mois., trfct))
text_df$data <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2],diagnostique=X[,3], jeux=X[,4], sommeil=X[,5],contact=X[,6],habitute=X[,7],qui=X[,8],antecedents=X[,9],tranche=X[10])
tidytext = text_df$data %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X3<-X[X$tranche=="inf18",]
text_df$data <- tibble(line = 1:nrow(X3), X3$preoccupation)
X3$preoccupation
X3[,1]
colnames(X3)<-""
X3
text_df$data <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
#donnée sujet 2 :
X2=X[!str_detect(X$diagnostique, "pas de TSA") & !str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
text_df$data <- tibble(line = 1:nrow(X2), preoccupation = X2[,1], motif=X2[,2],diagnostique=X2[,3], jeux=X2[,4], sommeil=X2[,5],contact=X2[,6],habitute=X2[,7],qui=X2[,8],antecedents=X2[,9])
shiny::runApp('Projet_TM')
df<-read.xlsx2("BDD_CEDA_dec_2020_complete - ANONYME.xlsx", sheetIndex = 1,header = TRUE)
new_df<-data.frame(df$Préoccupations,df$Motif.de.consult,df$Diagnostic.,df$jeux.et.activités,df$Sommeil,df$Entrée.en.contact,df$Habitudes.de.l.enfant,df$Qui,df$Antécédents,df$X1eres.inquiétudes..mois.)
X=new_df[,1:9]
colnames(X) = c("preoccupations","motif", "diagnostique", "jeux","sommeil","contact","habitute","qui","antecedents")
#donnée sujet 2 :
X2=X[!str_detect(X$diagnostique, "pas de TSA") & !str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
text_df$data <- tibble(line = 1:nrow(X2), preoccupation = X2[,1], motif=X2[,2],diagnostique=X2[,3], jeux=X2[,4], sommeil=X2[,5],contact=X2[,6],habitute=X2[,7],qui=X2[,8],antecedents=X2[,9])
text_df$data <- tibble(line = 1:nrow(X), preoccupation = X[,1], motif=X[,2],diagnostique=X[,3], jeux=X[,4], sommeil=X[,5],contact=X[,6],habitute=X[,7],qui=X[,8],antecedents=X[,9])
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
#nouvelle variable
X$tranche<-df$X1eres.inquiétudes..mois.
X$tranche<-unlist(lapply(df$X1eres.inquiétudes..mois., trfct))
X3<-X[X$tranche=="entre18et24",]
colnames(X3)<-""
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X3<-X[X$tranche=="entre24et36",]
colnames(X3)<-""
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X3<-X[X$tranche=="sup36",]
colnames(X3)<-""
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
View(df)
View(df)
summary(df$X1eres.inquiétudes..mois.)
library(stringr)
#Des la naissance : 0
df$X1eres.inquiétudes..mois.[str_detect(df$X1eres.inquiétudes..mois.,"naissance")]<-0
#Recodage années en mois :
for (i in 1:length(df$X1eres.inquiétudes..mois.)) {
if (str_detect(df$X1eres.inquiétudes..mois.[i],"ans")) {
df$X1eres.inquiétudes..mois.[i]<-as.numeric(substr(df$X1eres.inquiétudes..mois.[i],1,str_locate(df$X1eres.inquiétudes..mois.[i], " ans")[1]-1))*12
}
}
#transforme la variable en numéric pour garder que les valeurs numéric
df$X1eres.inquiétudes..mois.<-as.numeric(df$X1eres.inquiétudes..mois.)
summary(df$X1eres.inquiétudes..mois.)
X3=X[!str_detect(X$diagnostique, "pas de TSA") & !str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X3=X[str_detect(X$diagnostique, "pas de TSA") & str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
X3
X$diagnostique
X3=X[(str_detect(X$diagnostique, "pas de TSA") | str_detect(X$diagnostique, "Pas de TSA")) & X$diagnostique!="",]
X3
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X3=X[!str_detect(X$diagnostique, "pas de TSA") & !str_detect(X$diagnostique, "Pas de TSA") & X$diagnostique!="",]
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
X[!str_detect(X$sommeil, "non") & !str_detect(X$sommeil, "Non") & X$diagnostique!="",]
X[(str_detect(X$sommeil, "non") | str_detect(X$sommeil, "Non")) & X$diagnostique!="",]
X[(str_detect(X$sommeil, " non") | str_detect(X$sommeil, "Non")) & X$diagnostique!="",]
X3=X[!str_detect(X$sommeil, "non") & !str_detect(X$sommeil, "Non") & X$diagnostique!="",]
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
wc<-function(X3){
test <- tibble(line = 1:nrow(X3), preoccupation = X3[,1], motif=X3[,2],diagnostique=X3[,3], jeux=X3[,4], sommeil=X3[,5],contact=X3[,6],habitute=X3[,7],qui=X3[,8],antecedents=X3[,9],tranche=X3[10])
tidytext = test %>% unnest_tokens(word, as.numeric(preoccupation))
tidytext = tidytext[,-2]
test_clean_df <- tidytext %>% filter(!word %in% c(stopwords('french'),'a','très','d\'un','qu\'il','nc','avoir','afin'))
#Fréquence des mots
freq=test_clean_df %>%
count(word,sort=T)
wordcloud2(freq, color="random-light", size = .3, shuffle=T, rotateRatio = sample(c(1:100) / 100))
}
X3=X[!str_detect(X$sommeil, "non") & !str_detect(X$sommeil, "Non") & X$diagnostique!="",]
X4=X[(str_detect(X$sommeil, "non") | str_detect(X$sommeil, "Non")) & X$diagnostique!="",]
wc(X3)
wc(X4)
View(new_df)
View(new_df)
